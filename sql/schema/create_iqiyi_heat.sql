CREATE TABLE public.zhaoxuelu_heat_iqiyi (
	insert_time TIMESTAMP WITH TIME ZONE DEFAULT now(), 
	heat_info INTEGER,                 
    effect_score NUMERIC(3,1),           	                      
    hot_link INTEGER,             --final version                           
	
	CONSTRAINT linjiangxian_heat_time UNIQUE (insert_time)
);

--Manually fill in the missing data
INSERT INTO zhaoxuelu_heat_iqiyi (insert_time,heat_info,hot_link)
VALUES 
(2025-07-25 11:50:40, 9886, 1 ),
(2025-07-25 12:00:10, 9896, 1),
(2025-07-25 12:10:33, 9906, 1),
(2025-07-25 12:20:39, 9918, 1),
(2025-07-25 12:30:51, 9936, 1),
(2025-07-25 12:40:37, 9948, 1),
(2025-07-25 12:50:36, 9960, 1),
(2025-07-25 13:01:02, 9968, 1),
(2025-07-25 13:10:54, 9975, 1),
(2025-07-25 13:20:42, 9978, 1),
(2025-07-25 13:31:04, 9977, 1),
(2025-07-25 13:41:07, 9974, 1),
(2025-07-25 14:02:52, 9964, 1),
(2025-07-25 14:14:44, 9957, 1),
(2025-07-25 15:53:47, 9912, 1),
(2025-07-25 16:15:00, 9911, 1),
(2025-07-25 16:25:10, 9911, 1),
(2025-07-25 16:34:24, 9910, 1),
(2025-07-25 16:45:13, 9910, 1),
(2025-07-25 16:55:16, 9910, 1),
(2025-07-25 17:05:22, 9910, 1),
(2025-07-25 17:15:00, 9911, 1),
(2025-07-25 17:26:14, 9912, 1),
(2025-07-25 17:43:59, 9915, 1),
(2025-07-25 17:52:52, 9918, 1),
(2025-07-25 18:05:20, 9934, 1),
(2025-07-25 18:15:03, 9950, 1),
(2025-07-25 18:22:48, 9964, 1),
(2025-07-25 18:33:03, 9982, 1),
(2025-07-25 18:42:36, 9998, 1),
(2025-07-25 18:52:40, 10013, 1),
(2025-07-25 19:02:41, 10026, 1),
(2025-07-25 19:13:02, 10037, 1),
(2025-07-25 19:22:31, 10048, 1),
(2025-07-25 19:32:42, 10056, 1),
(2025-07-25 19:43:31, 10069, 1),
(2025-07-25 19:52:55, 10078, 1),
(2025-07-25 20:03:09, 10083, 1),
(2025-07-25 20:13:11, 10086, 1),
(2025-07-25 20:24:05, 10088, 1),
(2025-07-25 20:33:10, 10090, 1),
(2025-07-25 20:43:27, 10091, 1),
(2025-07-25 20:59:20, 10090, 1),
(2025-07-25 21:03:24, 10085, 1),
(2025-07-25 21:13:42, 10083, 1),
(2025-07-25 21:24:31, 10082, 1),
(2025-07-25 21:36:38, 10081, 1),
(2025-07-25 22:06:15, 10076, 1),
(2025-07-25 22:22:39, 10075, 1),
(2025-07-25 23:40:12, 10042, 1),
(2025-07-25 23:57:00, 10025, 1),
(2025-07-26 00:45:43, 9967, 1),
(2025-07-26 01:01:47, 9952, 1);


INSERT INTO zhaoxuelu_heat_iqiyi (insert_time,heat_info,hot_link)
VALUES 
(TIMESTAMP WITH TIME ZONE '2025-07-25 05:50:40+02', 9886, 1 ),
(TIMESTAMP WITH TIME ZONE '2025-07-25 06:00:10+02', 9896, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 06:10:33+02', 9906, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 06:20:39+02', 9918, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 06:30:51+02', 9936, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 06:40:37+02', 9948, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 06:50:36+02', 9960, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 07:01:02+02', 9968, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 07:10:54+02', 9975, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 07:20:42+02', 9978, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 07:31:04+02', 9977, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 07:41:07+02', 9974, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 08:02:52+02', 9964, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 08:14:44+02', 9957, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 09:53:47+02', 9912, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 10:15:00+02', 9911, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 10:25:10+02', 9911, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 10:34:24+02', 9910, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 10:45:13+02', 9910, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 10:55:16+02', 9910, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 11:05:22+02', 9910, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 11:15:00+02', 9911, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 11:26:14+02', 9912, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 11:43:59+02', 9915, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 11:52:52+02', 9918, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 12:05:20+02', 9934, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 12:15:03+02', 9950, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 12:22:48+02', 9964, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 12:33:03+02', 9982, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 12:42:36+02', 9998, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 12:52:40+02', 10013, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 13:02:41+02', 10026, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 13:13:02+02', 10037, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 13:22:31+02', 10048, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 13:32:42+02', 10056, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 13:43:31+02', 10069, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 13:52:55+02', 10078, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 14:03:09+02', 10083, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 14:13:11+02', 10086, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 14:24:05+02', 10088, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 14:33:10+02', 10090, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 14:43:27+02', 10091, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 14:59:20+02', 10090, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 15:03:24+02', 10085, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 15:13:42+02', 10083, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 15:24:31+02', 10082, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 15:36:38+02', 10081, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 16:06:15+02', 10076, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 16:22:39+02', 10075, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 17:40:12+02', 10042, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 17:57:00+02', 10025, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 18:45:43+02', 9967, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-25 19:01:47+02', 9952, 1);

--Inserted 2025.07.30
INSERT INTO zhaoxuelu_heat_iqiyi (insert_time,heat_info,hot_link)
VALUES 
(TIMESTAMP WITH TIME ZONE '2025-07-28 15:32:56+02', 10279, 1 ),
(TIMESTAMP WITH TIME ZONE '2025-07-28 15:42:29+02', 10278, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-28 15:53:12+02', 10276, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-28 16:05:00+02', 10275, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-28 16:26:43+02', 10269, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-28 16:43:39+02', 10260, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-28 17:44:12+02', 10208, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-28 17:54:00+02', 10197, 1),
(TIMESTAMP WITH TIME ZONE '2025-07-28 18:00:43+02', 10197, 1);


--Convert to Shanghai time
UPDATE shujuanyimeng_heat_iqiyi
SET timestamp_shanghai = insert_time AT TIME ZONE 'Asia/Shanghai'
WHERE timestamp_shanghai IS NULL;

--Remove redundant column because of not updating with inster_time
ALTER TABLE shujuanyimeng_heat_iqiyi DROP COLUMN timestamp_shanghai;


--Create statistic table of weibo parameters
CREATE TABLE weibo_user_stats (
    id SERIAL PRIMARY KEY,           -- Auto-increment unique ID
    user_id BIGINT NOT NULL,
    followers_count BIGINT,
    followings_count BIGINT,
    likes_count BIGINT,
    recorded_at TIMESTAMP WITH TIME ZONE DEFAULT now(),  
    UNIQUE(user_id, recorded_at)      
);


CREATE TABLE weibo_user (        
    user_id BIGINT PRIMARY KEY,
    user_name VARCHAR(20)     
);

INSERT INTO weibo_user (user_id, user_name)
VALUES 
(1265743747, '李兰迪'),
(1798539915, '檀健次'),
(5643994130, '敖瑞鹏');

SHOW TIMEZONE;




